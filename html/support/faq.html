<html>

<head>

<title>SUNDIALS FAQ</title>

<meta name="author" content="Radu Serban">
<meta name="description" content="suite of nonlinear differential algebraic equation solvers">
<meta name="keywords" content="SUNDIALS, CVODE, CVODES, IDA, KINSOL">
<meta name="keywords" content="ODE, DAE, sensitivity">
<meta name="keywords" content="differential, algebraic">
<link REL="SHORTCUT ICON" HREF="img/favicon.ico" type="image/x-icon">
<link REL="ICON" HREF="img/favicon.ico" type="image/x-icon">
<link href="../sundials_styles.css" rel="stylesheet" type="text/css">
<script language="JavaScript">
<!--
homeon = new Image();           homeon.src = "../graphics/home_buttonH.png";
homeoff = new Image();          homeoff.src = "../graphics/home_button.png";
descriptionon = new Image();    descriptionon.src = "../graphics/description_buttonH.png";
descriptionoff = new Image();   descriptionoff.src = "../graphics/description_button.png";
documentationon = new Image();  documentationon.src = "../graphics/documentation_buttonH.png";
documentationoff = new Image(); documentationoff.src = "../graphics/documentation_button.png";
downloadon = new Image();       downloadon.src = "../graphics/download_buttonH.png";
downloadoff = new Image();      downloadoff.src = "../graphics/download_button.png";
supporton = new Image();        supporton.src = "../graphics/support_buttonH.png";
supportoff = new Image();       supportoff.src = "../graphics/support_button.png";
//-->
</script>
<script src="../sunjs.js" type="text/javascript" language="javascript1.2"></script>

</head>

<!-- ******************************************************************************** -->

<body>


<table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">

  <tr valign="top">
  <td height="60" background="../graphics/table_bck1.gif"><img src="../graphics/table_bck1.gif" width="5" height="60"></td>
  <td width="116"><img SRC="../graphics/head_top_left.png" height="60" width="116" border="0"></td>
  <td width="720"><img SRC="../graphics/head_support_top_right.png" height="60" width="720" border="0"></td>
  <td background="../graphics/table_bck1.gif"><img src="../graphics/table_bck1.gif" width="5" height="60"></td>
  </tr>

  <tr valign="top">
  <td height="127" background="../graphics/table_bck2.gif"><img src="../graphics/table_bck2.gif" width="5" height="127"></td>
  <td width="116">
    <a href="../main.html" onMouseOver="img_act('home'); return true;" onMouseOut="img_inact('home'); return true;"><img src="../graphics/home_button.png" border="0" name="home"></a><br>
    <a href="../description/description.html" onMouseOver="img_act('description'); return true;" onMouseOut="img_inact('description'); return true;"><img src="../graphics/description_button.png" border="0" name="description"></a><br>
    <a href="../documentation/documentation.html" onMouseOver="img_act('documentation'); return true;" onMouseOut="img_inact('documentation'); return true;"><img src="../graphics/documentation_button.png" border="0" name="documentation"></a><br>
    <a href="../download/download.html" onMouseOver="img_act('download'); return true;" onMouseOut="img_inact('download'); return true;"><img src="../graphics/download_button.png" border="0" name="download"></a><br>
    <a href="support.html" onMouseOver="img_act('support'); return true;" onMouseOut="img_inact('support'); return true;"><img src="../graphics/support_button.png" border="0" name="support"></a><br>
    <img SRC="../graphics/line_tl.gif" height="7" width="116" border="0"></td>
  <td width="720">
      <img SRC="../graphics/head_bottom_right.png" height="120" width="720" border="0"><br>
      <img SRC="../graphics/line_tr.gif" height="7" width="720" border="0"></td>
  <td background="../graphics/table_bck2.gif"><img src="../graphics/table_bck2.gif" width="5" height="127"></td>
  </tr>

  <tr valign="top">
  <td background="../graphics/table_bck3.gif"></td>
  <td width="116" valign="bottom" align="center" background="../graphics/table_bck5.gif">
    <a href="../sitemap.html"><img SRC="../graphics/sitemap.png" border="0"></a><img SRC="../graphics/logo.png" border="0">
  </td>

  <td width="720" bgcolor="#ffffff">
  <div id="content">   

<!-- Start content for this page -->

<div class="title">Frequently Asked Questions</div>
<br><br>

<!-- ------ -->

<h1>Contents</h1>
<div class="frame">
<ul>
<li><a href="#inst">Installation</a>
  <ul>
  <li><a href="#inst_path">I got the tarball. What do I do next?</a></li>
  <li><a href="#inst_linux">What configure flags do I really need?</a></li>
  <li><a href="#inst_c++">Can I use a C++ compiler to build SUNDIALS?</a></li>
  <li><a href="#inst_noconfig">How do I build SUNDIALS without using the configure script?</a></li>
  <li><a href="#inst_win">How do I install SUNDIALS under Windows?</a></li>
  <li><a href="#inst_cygwin">How can I generate shared libraries under cygwin?</a></li>
  </ul>
<li><a href="#cvode">CVODE / CVODES</a>
  <ul>
  <li><a href="#cvode_tols">How do I choose tolerances?</a></li>
  <li><a href="#cvode_negvals">How do I control unphysical negative values?</a></li>
  <li><a href="#cvode_disc">How do I treat discontinuities in the RHS function?</a></li>
  <li><a href="#cvode_ewtfn">When is it advantegeous to supply my own EwtFn function?</a></li>
  <li><a href="#cvodes_senstoggle">How do I switch on/off forward sensitivity computations in CVODES?</a></li>
  <li><a href="#cvodes_plist">What is the role of plist in CVODES?</a></li>
  <li><a href="#cvodes_pbar">What is the role of pbar in CVODES?</a></li>
  <li><a href="#cvodes_quad">What is pure quadrature integration?</a></li>
  </ul>
<li><a href="#ida">IDA</a>
  <ul>
  <li><a href="#ida_tols">How do I choose tolerances in IDA?</a></li>
  <li><a href="#ida_negvals">How do I control unphysical negative values in IDA?</a></li>
  <li><a href="#ida_disc">How do I treat discontinuities in the residual function in IDA?</a></li>
  <li><a href="#ida_ewtfn">When is it advantegeous to supply my own EwtFn function?</a></li>
  </ul>
<!--
<li><a href="#kinsol">KINSOL</a>
  <ul>
  <li></li>
  <li></li>
  <li></li>
  </ul>
<li><a href="#stb">sundialsTB</a>
  <ul>
  <li></li>
  <li></li>
  <li></li>
  </ul>
-->
</ul>

</div>

<!-- ================ INSTALLATION ===========================  -->

<a name="inst"></a>
<h1>Installation</h1>
<div class="frame">

<a name="inst_path"></a>
<div class="faq_q">I got the tarball. What do I do next?</div>
<div class="faq_a">
Let's assume you downloaded <tt>sundials.tar.gz</tt>.
First, you'll have to uncompress and unpack it:
<pre>
% tar -xzf sundials.tar
</pre>
This will create a directory <tt>sundials</tt>, which we will call the <em>source tree</em>.
<br><br>
Next, you need to configure and build the SUNDIALS libraries. You can get some information 
on how to do this here, but more details are available in the user guides 
(e.g. <tt>sundials/cvode/doc/cv_guide.pdf</tt>).
<br><br>
Note that, since we expect most of our users to do local installs of the SUNDIALS packages,
our build system does not respect the usual *NIX convention of installing by
default in <tt>/usr/local</tt>. Instead, the default is to install the libraries and
header files in two directories, <tt>lib</tt> and <tt>include</tt>, respectively,
which are automatically created in the directory from where <tt>configure</tt> was invoked.
<br><br>
It is not recommended to build SUNDIALS in its source directory. Instead, create a separate <tt>build</tt>
directory (for example as a subdirectory of <tt>sundials</tt>) and invoke <tt>configure</tt> from there.
This way, you could maintain several different installations, using different compilers, 
options (e.g. debug and optimized), etc. 
</div>

<a name="inst_linux"></a>
<div class="faq_q">What configure flags do I really need?</div>
<div class="faq_a">
That depends a lot on how your system is configured. If all compilers, libraries, and system 
header files are in the usual places, configuring SUNDIALS can be as simple as:
<pre>
% /path/to/sundials/source/tree/configure
% make
% make install
</pre>
In certain circumstances, more sophisticated configure lines may be needed, especially
when building SUNDIALS with MPI support and/or the Fortran-C interfaces. For example, 
to build SUNDILAS using <tt>gcc</tt> as the serial C compiler, <tt>g77</tt> as the 
serial Fortran compiler, using the MPI compiler scripts <tt>mpicc</tt> and
<tt>mpif77</tt> from a particular MPICH distribution, and using the additional 
compiler flag <tt>-g3</tt>, you would use:
<pre>
% configure CC=gcc F77=g77 --with-cflags=-g3 --with-fflags=-g3 \
      --with-mpicc=/usr/apps/mpich/1.2.4/bin/mpicc \ 
      --with-mpif77=/usr/apps/mpich/1.2.4/bin/mpif77
</pre>

</div>

<a name="inst_c++"></a>
<div class="faq_q">Can I use a C++ compiler to build SUNDIALS?</div>
<div class="faq_a">
Yes. However, if building SUNDIALS using a C++ compiler and with parallel support, 
you must take care <b>not</b> to include MPI C++ bindings. This can be done by 
specifying an implementation-dependent MPI flag using --with-mpi-flags:
<br>
&nbsp;&nbsp;&nbsp;&diams; for MPICH, use --with-mpi-flags=-DMPICH_SKIP_MPICXX
<br>
&nbsp;&nbsp;&nbsp;&diams; for LAM MPI, use --with-mpi-flags=-DLAM_BUILDING
<br><br>
Note that, if you want to use an MPI script, you must specify, through --with-mpicc, 
the wrapper using the C++ compiler (mpiCC or mpic++, depending on your MPI distribution). 
If a C++ compiler is specified and --with-mpicc is not specified, the SUNDIALS configure 
script will automaticall select the correct MPI script. 
</div>


<a name="inst_noconfig"></a>
<div class="faq_q">How do I install SUNDIALS without using the configure script?</div>
<div class="faq_a">
Complete details on bulding SUNDIALS without using the default build system are provided
in the "Building SUNDIALS without the configure script" section of the installation
chapter in any of the SUNDIALS user guides. This type of installation  requires manually
creating the <tt><b>sundials_config.h</b></tt> header file
[ <a href="samples/sundials_config.h.html" onclick="window.open('samples/sundials_config.h.html', 'popup', 'width=600,height=800,scrollbars=yes,menubar=yes');return false">view</a> | <a href="samples/sundials_config.h">download</a> ]
</div>

<a name="inst_win"></a>
<div class="faq_q">How do I install SUNDIALS under Windows?</div>
<div class="faq_a">
The easiest way of obtaining Windows libraries for the SUNDIALS solvers is probably
to use <tt>cygwin</tt> (<a href="http://www.cygwin.com" target="_blank">www.cygwin.com</a>),
in which case the installation procedure is the same as for any other *NIX system.
<br><br>

Several of our users have reported successfuly building the SUNDIALS libraries using
various IDEs (Borland C++, Visual C++, etc.). For more details, see 
<a href="#inst_noconfig">How do I install SUNDIALS without using the configure script?</a> 
and browse the <a href="mailArchive/maillist.html" target="_blank">sundials-users</a> 
mailing list.
<br><br>
Instructions to compile SUNDIALS with VC8 - Visual Studio C++ Express 2005
(courtesy of Andreas Nicolai)
<ol>
<li>
  extract SUNDIALS archive
</li>
<li>
  copy (and optionally edit) the sample <tt><b>sundials_config.h</b></tt> header file
[ <a href="samples/sundials_config.h.html" onclick="window.open('samples/sundials_config.h.html', 'popup', 'width=600,height=800,scrollbars=yes,menubar=yes');return false">view</a> | <a href="samples/sundials_config.h">download</a> ]
</li>
<li>
  create subdirectories <tt>projects</tt>, <tt>includes</tt>, and <tt>libs</tt>
  <br>
  copy all include files from the various subdirectories in SUNDIALS into
  the <tt>includes</tt> folder (Windows doesn't have softlinks unfortunately)
</li>
<li>
  create the SUNDIALS libraries that you need
  <br>
  here is the general procedure that you have to follow for each library
  <ul>
  <li> start VC </li>
  <li> create new project<br>
       Type: Win32 Console Application<br>
       Name: libXXX<br>
       Place: in directory <tt>projects</tt><br>
       In New Project Wizard, select application settings page and choose:<br>
       - static library<br>
       - uncheck "precompiled headers"
  </li>
  <li> add existings source files to Sources and Headers 
       (files are in the appropriate SUNDIALS subdirs)
  </li>
  <li> open project properties and modify settings:<br>
       "Configuration properties" - "General"<br>
       - change "Output Directory" to <tt>../../libs</tt><br>
       "Configuration properties" - "C++" : "Additional Include Directories"<br>
       - add appropriate include directories here (see below)<br>
       "Configuration properties" - "C++" : "Code generation"<br>
       - change "Runtime Library" to "Multi-threaded (/MT)"<br>
         (links to the static runtime library)<br>
       "Configuration properties" - "C++" : "Preprocessor"<br>
       - add "HAVE_CONFIG_H" to "Preprocessor Definitions"
  </li>
  </ul>
</li>
<li>
  specific settings for various libraries
  <ul>
  <li> libNVector:<br>
       source to add: <tt>nvector_serial.c</tt> to Sources and <tt>nvector_serial.h</tt> to Headers
                      (files are in subdir 'nvec_ser')<br>
       includes: <tt>../..; ../../shared/include</tt>
  </li>
  <li> libCVode:<br>
       source to add: all in subdirs <tt>cvode/include</tt> and <tt>cvode/source</tt>,
                      all in subdirs <tt>shared/include</tt> and <tt>shared/source</tt><br>
       includes: <tt>../..; ../../shared/include; ../../cvode/include; ../../cvode/source</tt>
  </li>
  <li> for all other solver libs use similar settings as for libCVode</li>
  </ul>
</li>
<li>
  linking programs to SUNDIALS libs
  <ul>
  <li> once all libraries have been created, they should be in the <tt>libs</tt> 
       subdir while all header files should be copied to <tt>includes</tt></li>
  <li> external SUNDIALS users must add the include directory and link to all used
       libraries, typically libNVector and one of the solver libs</li>
  </ul>
</li>
</ol>

</div>

<a name="inst_cygwin"></a>
<div class="faq_q">How can I generate shared libraries under cygwin?</div>
<div class="faq_a">
In order to create shared libraries (DLLs) under <tt>cygwin</tt>, you must <b>regenerate</b> the
<tt>configure</tt> script using <tt>cygwin</tt>'s autotools and use the <tt>-no-undefined</tt>
option to <tt>libtool</tt>.
<ol>
<li>
Remove, if they exist, the <tt>aclocal.m4</tt> file and <tt>autom4te.cache</tt>
directory:
<pre>
% rm -rf aclocal.m4 autom4te.cache
</pre>
</li>
<li>
Regenerate the <tt>configure</tt> script:
<pre>
% aclocal
% autoconf
% autoheader
</pre>
</li>
<li>
Configure SUNDIALS, enabling creation of shared libraries and using the required
flag:
<pre>
% /path/to/sundials/source/tree/configure --enable-shared --with-ldflags=-no-undefined
</pre>
</li>
</ol>
</div>

</div>

<!-- ================= CVODE ===================== -->

<a name="cvode"></a>
<h1>CVODE / CVODES</h1>
<div class="frame">

<a name="cvode_tols"></a>
<div class="faq_q">How do I choose tolerances?</div>
<div class="faq_a">
For many users, the appropriate choices for tolerance values are a
concern.  The following pieces of advice are relevant.
<ol>
<li> The scalar relative tolerance reltol is to be set to control relative
errors.  So reltol = 1.0E-4 means that errors are controlled to .01%.  We
do not recommend using reltol larger than 1.0E-3.  On the other hand,
reltol should not be so small that it is comparable to the unit roundoff
of the machine arithmetic (generally around 1.0E-15).</li>
<li> The absolute tolerances abstol (whether scalar or vector) need to
be set to control absolute errors when any components of the solution
vector y may be so small that pure relative error control is
meaningless.  For example, if y[i] starts at some nonzero value, but in time
decays to zero, then pure relative error control on y[i] makes no sense
(and is overly costly) after y[i] is below some noise level.  Then
abstol (if scalar) or abstol[i] (if a vector) needs to be set to that
noise level.  If the different components have different noise levels,
then abstol should be a vector.  See the example cvdx in the CVODE
package, and the discussion of it in the CVODE Examples document.
In that problem, the three components vary betwen 0 and 1, and have
different noise levels; hence the abstol vector.  It is impossible to
give any general advice on abstol values, because the appropriate noise
levels are completely problem-dependent.  The user or modeler hopefully has
some idea as to what those noise levels are.</li>
<li> Finally, it is important to pick all the tolerance values conservatively,
because they control the error committed on each individual time step.
The final (global) errors are some sort of accumulation of those
per-step errors.  A good rule of thumb is to reduce the tolerances by a
factor of .01 from the actual desired limits on errors.  So if you
want .01% accuracy (globally), a good choice is reltol = 1.0E-6.
But in any case, it is a good idea to do a few experiments with
the tolerances to see how the computed solution values vary as
tolerances are reduced.</li>
</ol>
</div>

<a name="cvode_negvals"></a>
<div class="faq_q">How do I control unphysical negative values?</div>
<div class="faq_a">
In many applications, some components in the true solution are always
positive or non-negative, though at times very small.  In the numerical
solution, however, small negative (hence unphysical) values can then
occur.  In most cases, these values are harmless, and simply need to
be controlled, not eliminated. The following pieces of advice are relevant.
<ol>
<li> The way to control the size of unwanted negative computed values
is with tighter absolute tolerances.  Again this requires some
knowledge of the noise level of these components, which may or may not
be different for different components.  Some experimentation may be
needed.</li>
<li> If output plots or tables are being generated, and it is important
to avoid having negative numbers appear there (for the sake of avoiding
a long explanation of them, if nothing else), then eliminate them, but
only in the context of the output medium.  Then the internal values carried
by the solver are unaffected.  Remember that a small negative value in y
returned by CVODE, with magnitude comparable to abstol or less,
is equivalent to zero as far as the computation is concerned.</li>
<li> The user's right-hand side routine f should <b>never</b> change a
negative value in the solution vector y to a non-negative value,
as a "solution" to this problem.  This can cause instability.  If the
f routine cannot tolerate a zero or negative value (e.g. because
there is a square root or log of it), then the offending value should
be changed to zero or a tiny positive number in a temporary variable
(<b>not</b> in the input y vector) for the purposes of computing f(t,y).</li>
</ol>
</div>

<a name="cvode_disc"></a>
<div class="faq_q">How do I treat discontinuities in the RHS function?</div>
<div class="faq_a">
If the jumps at the discontinuities are relatively small, simply
keep them in the RHS function, and let the integrator respond to
them (possibly taking smaller steps through each point of discontinuity).
If the jumps are large, it is more efficient to stop at the point of
discontinuity and restart the integrator with a readjusted ODE model.
To stop when the location of the discontinuity is known, simply make
that location a value of tout.  To stop when the location of the
discontinuity is determined by the solution, use the rootfinding feature.
In either case, it is critical that the RHS function <b>not</b> incorporate
the discontinuity, but rather have a smooth extention over the
discontinuity, so that the step across it (and subsequent rootfinding,
if used) can be done efficiently.  Then use a switch within the
RHS function that can be flipped between the stopping of the
integration and the restart, so that the restarted problem uses the
new values (which have jumped).
</div>

<a name="cvode_ewtfn"></a>
<div class="faq_q">When is it advantegeous to supply my own EwtFn function?</div>
<div class="faq_a">
The main situation where this is a good idea is where the problem
needs something "in between" the cases covered by CV_SS and CV_SV.
Namely, suppose there are a few groups of variables (relative to the
total number of variables) such that all the variables in each group
require the same value of abstol, but these values are very different
from one group to another.  Then a user EwtFn function can keep an
array of those values and construct the ewt vector without any
additional storage.  Also, <i>in rare cases</i>, one may want to use this
option to apply different values of reltol to different variables (or
groups of variables).
</div>

<a name="cvodes_senstoggle"></a>
<div class="faq_q">How do switch on/off forward sensitivity computations in CVODES?</div>
<div class="faq_a">
If you want to turn on and off forward sensitivity calculations during several 
successive integrations (such as if you were using CVODES within a dynamically-constrained 
optimization loop, when sometimes you want to only integrate the states and sometimes you 
also need sensitivities computed), it is most efficient to use <tt>CVodeSensToggleOff</tt>. 
<br><br>
Sensitivity calculations are enabled by the following functions: 
<tt>CVodeSensMalloc</tt> and <tt>CVodeSensReInit</tt>
and are disabled by <tt>CVodeSensFree</tt> (after calling this one, they can 
be re-enabled <b>only</b> by calling <tt>CVodeSensMalloc</tt>) and 
<tt>CVodeSensToggleOff</tt>.
<br><br>
</div>

<a name="cvodes_plist"></a>
<div class="faq_q">What is the role of plist in CVODES?</div>
<div class="faq_a">
The argument <tt>plist</tt> to <tt>CVodeSetSensParams</tt> is used to specify the problem parameters 
with respect to which solution sensitivities are to be computed.
<br><br>
<tt>plist</tt> is used <b>only</b> if the sensitivity right-hand sides are evaluated using the 
internal difference-quotient approximation function. In that case, <tt>plist</tt> should be declared
as an array of <tt>Ns</tt> integers and should contain 
the indeces in the array of problem parameters <tt>p</tt> with respect to which sensitivities 
are desired. For example, if you want to compute sensitivities with respect to the first and 
third parameters in the <tt>p</tt> array, p[0] and p[2], you need to set 
<pre>
plist[0] = 0
plist[1] = 2
</pre>
<br>
If <tt>plist</tt> is not provided, CVODES will compute sensitivities with respect to the first <tt>Ns</tt>
parameters in the array <tt>p</tt> (i.e. it will use <tt>plist[i]=i, i=0,1,...Ns</tt>). 
<br><br>
If the user provides a function to evaluate the righ-hand sides of the sensitivity equations or if 
the default values are desired, a <tt>NULL</tt> pointer can be passed to <tt>CVodeSetSensParams</tt>.
</div>


<a name="cvodes_pbar"></a>
<div class="faq_q">What is the role of pbar in CVODES?</div>
<div class="faq_a">
The argument <tt>pbar</tt> to <tt>CVodeSetSensParams</tt> is used to specify scaling factors for
the problem parameters.
<br><br>
<tt>pbar</tt> is used <b>only if</b><br>
&diams; the internal difference-quotient functions are used for the evaluation of the sensitivity 
right-hand sides, in which case <tt>pbar</tt> is used in computing an appropriate perturbation 
for the finite-difference approximation<br>
<b>or</b><br>
&diams; the tolerances for the sensitivity variables are estimated automatically by CVODES from those
specified for the state variables.
<br><br>
If provided, <tt>pbar</tt> should be declared as an array of <tt>Ns</tt> <tt>realtype</tt>s and should 
contain <b>non-zero</b> scaling factors for the <tt>Ns</tt> parameters with respect to which
sensitivities are to be computed. For non-zero problem parameters, a good choice is
<pre>
pbar[i] = p[plist[i]]
</pre>
<br>
If <tt>pbar</tt> is not provided, CVODES will use <tt>pbar[i]=1.0, i=0,1,...Ns</tt>. 
<br><br>
If the user provides a function to evaluate the righ-hand sides of the sensitivity equations and also
specifies tolerances for the sensitivity variables (through <tt>CVodeSetSensTolerances</tt>) or if 
the default values are desired, a <tt>NULL</tt> pointer can be passed to <tt>CVodeSetSensParams</tt>.
</div>

<a name="cvodes_quad"></a>
<div class="faq_q">What is pure quadrature integration?</div>
<div class="faq_a">
Suppose your ODE is y'=F(t,y) and you integrate it from 0 to T and that
you are also interested in computing an integral of the form<br>
G = int_0^T g(t,y(t)) dt<br>
for some function g. The most efficient way of computing z is by
appending one additional differential equation to your ODE system:<br>
z' = g(t,y)<br>
with initial condition z(0)=0, in which case<br>
G = z(T)
<br><br>
This additional equation is "a pure quadrature equation" and its main characteristic is that the new differential 
variable z does not appear in the right hand side of the extended ODE system. If CVODES is notified of such "pure 
quadrature equations", it can take advantage of this property and do less work than if it didn't know about them
(these variables need not be considered in the nonlinear system solution).
<br><br>
The main reason for the special treatment of "pure quadrature equations" in CVODES is that such integrals (very often a
large number of them) need to be computed for adjoint sensitivity.
</div>


</div>

<!-- ================ IDA =================== -->

<a name="ida"></a>
<h1>IDA</h1>
<div class="frame">

<a name="ida_tols"></a>
<div class="faq_q">How do I choose tolerances in IDA?</div>
<div class="faq_a">
See <a href="#cvode_tols">How do I choose tolerances?</a> in the CVODE/CVODES section.
</div>

<a name="ida_negvals"></a>
<div class="faq_q">How do I control unphysical negative values in IDA?</div>
<div class="faq_a">
See <a href="#cvode_negvals">How do I control unphysical negative values?</a> in the CVODE/CVODES section.
<br>
In addition, IDA provides the option of enforcing positivity or non-negativity
on components.  But these constraint options should only be exercised if
the use of absolute tolerances to control the computed values is
unsuccessful, because they involve some extra overhead cost.
</div>

<a name="ida_disc"></a>
<div class="faq_q">How do I treat discontinuities in the residual function in IDA?</div>
<div class="faq_a">
See <a href="#cvode_disc">How do I treat discontinuities in the RHS function?</a> in the CVODE/CVODES section.
</div>

<a name="ida_ewtfn"></a>
<div class="faq_q">When is it advantegeous to supply my own EwtFn function?</div>
<div class="faq_a">
See <a href="#cvode_ewtfn">How do I treat discontinuities in the RHS function?</a> in the CVODE/CVODES section.
</div>

</div>

<!-- ================ KINSOL ================== -->

<!--

<a name="kinsol"></a>
<h1>KINSOL</h1>
<div class="frame">

<a name=""></a>
<div class="faq_q">Q?</div>
<div class="faq_a">
a
</div>

<a name=""></a>
<div class="faq_q">Q?</div>
<div class="faq_a">
a
</div>

</div>

-->

<!-- =============== sundialsTB ================== -->

<!--

<a name="stb"></a>
<h1>sundialsTB</h1>
<div class="frame">

<a name=""></a>
<div class="faq_q">Q?</div>
<div class="faq_a">
a
</div>

<a name=""></a>
<div class="faq_q">Q?</div>
<div class="faq_a">
a
</div>

</div>

-->

<!-- ------ -->

<!-- End content for this page -->
  </div>
  </td>

  <td background="../graphics/table_bck3.gif"></td>
  </tr>

  <tr valign="top">
  <td height="17" background="../graphics/table_bck4.gif"><img src="../graphics/table_bck4.gif" width="5" height="17"></td>
  <td width="116"><a HREF="http://www.llnl.gov/disclaimer.html" target="_top"><img SRC="../graphics/line_bl.gif" height="17" width="116" border="0"></a></td>
  <td width="720"><img SRC="../graphics/line_br.gif" height="17" width="720" border="0"></td>
  <td background="../graphics/table_bck4.gif"><img src="../graphics/table_bck4.gif" width="5" height="17"></td>
  </tr>

  </table>

</body>
</html>
