%===============================================================================
\section{Introduction}\label{s:ex_intro}
%===============================================================================

This report is intended to serve as a companion document to the User
Documentation of {\kinsol} \cite{kinsol_ug}.  It provides details, with
listings, on the example programs supplied with the {\kinsol} distribution
package.

The {\kinsol} distribution contains examples of many types, so as to
illustrate the use of various integrator options, various linear solver
options, and various {\nvector} kernels.
%%
With the exception of ''demo''-type example files, the names of all the examples 
distributed with {\sundials} are of the form
\verb![slv][PbName]_[strat]_[ls]_[prec]_[p]!, where
\begin{description}
\item [{[slv]}] identifies the solver (in this case \id{kin});
\item [{[PbName]}] identifies the problem;
\item [{[strat]}] identifies the strategy (absent if ``none'' or ``linesearch'');
\item [{[ls]}] identifies the linear solver module used;
\item [{[prec]}] indicates the {\kinsol} preconditioner module used
  (only if applicable, for examples using a Krylov linear solver
  and the {\kinbbdpre} module, this will be \id{bbd});
\item [{[p]}] indicates an example using the parallel vector module {\nvecp}.
\end{description}

\vspace{0.2in}\noindent
The following lists summarize all examples distributed with {\kinsol}.

\vspace{0.2in}\noindent
Supplied in the {\em srcdir}\id{/examples/kinsol/serial} directory are the
following serial examples (using the {\nvecs} module):

\begin{itemize}
\item \id{kinRoberts\_fp}
  solves the backward Euler time step for a three-species chemical kinetics
  system, using the fixed point strategy.

\item \id{kinFerTron\_dns}
  solves the Ferraris-Tronconi problem.
  \newline
  This program solves the problem with the {\sunlinsoldense} linear solver
  and uses different combinations of globalization and Jacobian
  update strategies with different initial guesses.
\item \id{kinFerTron\_klu}
  solves the same problem as in \id{kinFerTron\_dns}, but uses the
  sparse direct solver KLU via the {\sunlinsolklu} module.

\item \id{kinRoboKin\_dns}
  solves a nonlinear system from robot kinematics.
  \newline
  This program solves the problem with the {\sunlinsoldense} linear solver
  and a user-supplied Jacobian routine.
\item \id{kinRoboKin\_slu}
  is the same as \id{kinRoboKin\_dns} but uses the SuperLUMT sparse direct
  linear solver via the {\sunlinsolslumt} module.

\item \id{kinLaplace\_bnd}
  solves a simple 2-D elliptic PDE on a unit square.
 \newline
  This program solves the problem with the {\sunlinsolband} linear solver.
\item \id{kinLaplace\_picard\_bnd}
  is the same as \id{kinLaplace\_bnd} but uses the Picard strategy.
\item \id{kinLaplace\_picard\_kry}
  is the same as \id{kinLaplace\_picard\_bnd} but uses the SPGMR linear solver.

\item \id{kinFoodWeb\_kry}
  solves a food web model.
  \newline
  This is a nonlinear system that arises from a system of partial
  differential equations describing a six-species food web population
  model, with predator-prey interaction and diffusion on the unit
  square in two dimensions.
  This program solves the problem with the {\sunlinsolspgmr} linear
  solver module and a user-supplied preconditioner. The preconditioner is a
  block-diagonal matrix based on the partial derivatives of the
  interaction terms only.
\item \id{kinKrylovDemo\_ls}
  solves the same problem as \id{kinFoodWeb\_kry}, but with three Krylov
  linear solvers: {\sunlinsolspgmr}, {\sunlinsolspbcgs}, and {\sunlinsolsptfqmr}.

\item \id{kinAnalytic\_fp.c} solves a small nonlinear system with known solution.
  
\end{itemize}

\vspace{0.2in}\noindent
Supplied in the {\em srcdir}\id{/examples/kinsol/parallel} directory are
the following parallel examples (using the {\nvecp} module):
\begin{itemize}
\item \id{kinFoodWeb\_kry\_p}
  is a parallel implementation of \id{kinFoodWeb\_kry}.
\item \id{kinFoodWeb\_kry\_bbd\_p}
  solves the same problem as \id{kinFoodWeb\_kry\_p}, with a block-diagonal matrix
  with banded blocks as a preconditioner, generated by difference quotients,
  using the {\kinbbdpre} module.
\end{itemize}

\vspace{0.2in}\noindent
Supplied in the {\em srcdir}\id{/examples/kinsol/C\_openmp} directory
is an example \id{kinFoodweb\_kry\_omp}, which solves the same problem
as \id{kinFoodweb\_kry}, but using the \id{OpenMP} {\nector} module.

\vspace{0.2in}\noindent
Supplied in the {\em srcdir}\id{/examples/kinsol/CUDA\_mpi} directory
is an example \id{kin\_em\_mpicuda}, which solves an
expectation-maximization problem for mixture densities, using the
\id{cuda} {\nvector} module and MPI.

\vspace{0.2in}\noindent 
The following are examples written in C++:
\begin{itemize}

\item The directory {\em srcdir}\id{/examples/kinsol/CXX\_parallel}
  contains two examples. \id{kin\_heat2D\_nonlin\_p} solves a
  steady state 2D heat equation with an additional nonlinear term.
  This example is solved with fixed point iteration and illstrates
  the use of various orthogonalization methods with Anderson
  acceleration.
  \id{kin\_em\_p} solves the same problem as \id{kin\_em\_mpicuda}
  listed above.

\item The directory {\em srcdir}\id{/examples/kinsol/CXX\_parhyp}
  contains two examples, \id{kin\_heat2D\_nonlin\_hypre\_pfmg} and
  \id{kin\_bratu2D\_hyper\_pfmg}.  These use the \id{hypre}
  \id{PFMG} preconditioner, fixed point iteration, and Anderson
  acceleration.

\end{itemize}
  
\vspace{0.2in}\noindent
The following are examples in Fortran, using the {\sundials}
Fortran interface modules, and based on examples listed earlier:

\begin{itemize}

\item The directory {\em srcdir}\id{/examples/kinsol/F2003\_serial}
  contains four examples:
  \id{kinDiagon\_kry\_f2003} solves a simple diagonal test problem.
  \id{kinLaplace\_bnd\_f2003} solves the same problem as \id{kinLaplace\_bnd}.
  \id{kinLaplace\_picard\_kry\_f2003} solves the same problem as
  \id{kinLaplace\_picard\_kry}.
  \id{kinRoboKin\_dns\_f2003} solves the same problem as \id{kinRoboKin\_dns}.

\item The directory {\em srcdir}\id{/examples/kinsol/F2003\_parallel}
contains one example, \id{kin\_diagon\_kry\_f2003}, which solves
the same problem as \id{kinDiagon\_kry\_f2003}, but using MPI.
\end{itemize}


\vspace{0.2in}\noindent
In the following sections, we give detailed descriptions of some (but
not all) of these examples.  We also give our output files for
each of these examples, but users should be cautioned that their
results may differ slightly from these.  Differences in solution
values may differ within the tolerances, and differences in cumulative
counters, such as numbers of Newton iterations, may differ
from one machine environment to another by as much as 10\% to 20\%.

In the descriptions below, we make frequent references to the {\kinsol}
User Document \cite{kinsol_ug}.  All citations to specific sections
(e.g. \S\ref{s:types}) are references to parts of that User Document, unless
explicitly stated otherwise.

\vspace{0.2in}\noindent {\bf Note}.
The examples in the {\kinsol} distribution are written in such a way as
to compile and run for any combination of configuration options used during
the installation of {\sundials} (see Appendix \ref{c:install} in the User Guide).
As a consequence, they contain portions of code that will not be typically present in a
user program. For example, all {\CC} example programs make use of the
variables \id{SUNDIALS\_EXTENDED\_PRECISION} and \id{SUNDIALS\_DOUBLE\_PRECISION}
to test if the solver libraries were built in extended or double precision,
and use the appropriate conversion specifiers in \id{printf} functions.
