\newpage
\section{{\matlab} Interface to {\idas}}

The {\matlab} interface to {\idas} provides access to all functionality of the 
{\idas} solver, including DAE simulation and sensitvity analysis (both forward 
and adjoint).

The interface consists of 9 user-callable functions. The user must provide
several required and optional user-supplied functions which define the problem to be solved.
The user-callable functions and the types of user-supplied functions are listed in
Table \ref{t:idas_fct} and fully documented later in this section.
For more in depth details, consult also the {\idas} user guide~\cite{ida_ug}.

To illustrate the use of the {\idas} {\matlab} interface, several example problems are provided
with {\sundialsTB}, both for serial and parallel computations. Most of them are {\matlab} translations of example
problems provided with {\idas}.



\begin{table}[h]
\centering
\caption{{\idas} {\matlab} interface functions for DAE integration}
\label{t:idas_fct_ivp}
\medskip
\begin{tabular}{|r|l|r|}
  \hline
  IDASetOptions & create an options structure for an DAE problem. & \pageref{p:IDASetOptions} \\
  IDAQuadSetOptions & create an options structure for quadrature integration. & \pageref{p:IDAQuadSetOptions} \\
  \hline
  IDAInit       & allocate and initialize memory for {\idas}. & \pageref{p:IDAInit} \\
  IDAQuadInit   & allocate and initialize memory for quadrature integration. & \pageref{p:IDAQuadInit} \\  
  IDAReInit     & reinitialize memory for {\idas}. & \pageref{p:IDAReInit} \\
  IDAQuadReInit & reinitialize memory for quadrature integration. & \pageref{p:IDAQuadReInit} \\  
  \hline
  IDACalcIC     & compute consistent initial conditions. & \pageref{p:IDACalcIC} \\
  \hline
  IDASolve      & integrate the DAE problem. & \pageref{p:IDASolve} \\
  \hline
  IDAGetStats   & return statistics for the {\idas} solver. & \pageref{p:IDAGetStats} \\
  IDAGet        & extract data from {\idas} memory. & \pageref{p:IDAGet} \\
  \hline
  IDAFree       & deallocate memory for the {\idas} solver. & \pageref{p:IDAFree} \\
  \hline
  IDAMonitor    & monitoring function. & \pageref{p:IDAMonitor} \\
  \hline
\end{tabular}
\end{table}


\begin{table}[h]
\centering
\caption{{\idas} {\matlab} interface functions for FSA}
\label{t:idas_fct_fsa}
\medskip
\begin{tabular}{|r|l|r|}
  \hline
  IDASetOptions & create an options structure for an DAE problem. & \pageref{p:IDASetOptions} \\
  IDAQuadSetOptions & create an options structure for quadrature integration. & \pageref{p:IDAQuadSetOptions} \\
  IDASensSetOptions & create an options structure for FSA. & \pageref{p:IDASensSetOptions} \\
  \hline
  IDAInit       & allocate and initialize memory for {\idas}. & \pageref{p:IDAInit} \\
  IDAQuadInit   & allocate and initialize memory for quadrature integration. & \pageref{p:IDAQuadInit} \\  
  IDASensInit   & allocate and initialize memory for FSA. & \pageref{p:IDASensInit} \\
  IDAReInit     & reinitialize memory for {\idas}. & \pageref{p:IDAReInit} \\
  IDAQuadReInit & reinitialize memory for quadrature integration. & \pageref{p:IDAQuadReInit} \\  
  IDASensReInit & reinitialize memory for FSA. & \pageref{p:IDASensReInit} \\
  \hline
  IDASensToggleOff & temporarily deactivates FSA. & \pageref{p:IDASensToggleOff} \\
  \hline
  IDACalcIC     & compute consistent initial conditions. & \pageref{p:IDACalcIC} \\
  \hline
  IDASolve      & integrate the DAE problem. & \pageref{p:IDASolve} \\
  \hline
  IDAGetStats   & return statistics for the {\idas} solver. & \pageref{p:IDAGetStats} \\
  IDAGet        & extract data from {\idas} memory. & \pageref{p:IDAGet} \\
  \hline
  IDAFree       & deallocate memory for the {\idas} solver. & \pageref{p:IDAFree} \\
  \hline
  IDAMonitor    & monitoring function. & \pageref{p:IDAMonitor} \\
  \hline
\end{tabular}
\end{table}


\begin{table}[h]
\centering
\caption{{\idas} {\matlab} interface functions for ASA}
\label{t:idas_fct_asa}
\medskip
\begin{tabular}{|r|l|r|}
  \hline
  IDASetOptions & create an options structure for an DAE problem. & \pageref{p:IDASetOptions} \\
  IDAQuadSetOptions & create an options structure for quadrature integration. & \pageref{p:IDAQuadSetOptions} \\
  \hline
  IDAInit       & allocate and initialize memory for the forward problem. & \pageref{p:IDAInit} \\
  IDAQuadInit   & allocate and initialize memory for forward quadrature integration. & \pageref{p:IDAQuadInit} \\  
  IDAQuadReInit & reinitialize memory for forward quadrature integration. & \pageref{p:IDAQuadReInit} \\  
  IDAReInit     & reinitialize memory for the forward problem. & \pageref{p:IDAReInit} \\
  \hline
  IDAAdjInit    & allocate and initialize memory for ASA. & \pageref{p:IDAAdjInit} \\
  IDAInitB      & allocate and initialize a backward problem. & \pageref{p:IDAInitB} \\
  IDAAdjReInit  & reinitialize memory for ASA. & \pageref{p:IDAAdjReInit} \\
  IDAReInitB    & reinitialize a backward problem. & \pageref{p:IDAReInitB} \\
  \hline
  IDACalcIC     & compute consistent initial conditions. & \pageref{p:IDACalcIC} \\
  IDACalcICB    & compute consistent initial conditions for the backward problem. & \pageref{p:IDACalcICB} \\
  \hline
  IDASolve      & integrate the forward DAE problem. & \pageref{p:IDASolve} \\
  IDASolveB     & integrate the backward problems. & \pageref{p:IDASolveB} \\
  \hline
  IDAGetStats   & return statistics for the integration of the forward problem. & \pageref{p:IDAGetStats} \\
  IDAGetStatsB  & return statistics for the integration of a backward problem. & \pageref{p:IDAGetStatsB} \\
  IDAGet        & extract data from {\idas} memory. & \pageref{p:IDAGet} \\
  \hline
  IDAFree       & deallocate memory for the {\idas} solver. & \pageref{p:IDAFree} \\
  \hline
  IDAMonitor    & monitoring function for forward problem. & \pageref{p:IDAMonitor} \\
  IDAMonitorB   & monitoring function for backward problems. & \pageref{p:IDAMonitorB} \\
  \hline
\end{tabular}
\end{table}





\begin{table}[h]
\centering
\caption{{\idas} {\matlab} function types}
\label{t:idas_fct_types}
\medskip
\begin{tabular}{|c||r|l|r|}
  \hline
  \multirow{12}{*}{\begin{sideways} Forward problems \end{sideways}}
  &  IDARhsFn         &  residual function & \pageref{p:IDARhsFn} \\
  &  IDARootFn        &  root-finding function  & \pageref{p:IDARootFn} \\
  &  IDAQuadRhsFn     &  quadrature RHS function & \pageref{p:IDAQuadRhsFn} \\
  &  IDASensRhsFn     &  sensitivity RHS function & \pageref{p:IDASensRhsFn} \\
  &  IDADenseJacFn    &  dense Jacobian function & \pageref{p:IDADenseJacFn} \\
  &  IDABandJacFn     &  banded Jacobian function & \pageref{p:IDABandJacFn} \\
  &  IDAJacTimesVecFn &  Jacobian times vector function & \pageref{p:IDAJacTimesVecFn} \\
  &  IDAPrecSetupFn   &  preconditioner setup function & \pageref{p:IDAPrecSetupFn} \\
  &  IDAPrecSolveFn   &  preconditioner solve function & \pageref{p:IDAPrecSolveFn} \\
  &  IDAGlocalFn      &  residual approximation function (BBDPre) & \pageref{p:IDAGlocalFn} \\
  &  IDAGcommFn       &  communication function (BBDPre) & \pageref{p:IDAGcommFn} \\
  &  IDAMonitorFn     &  monitoring function & \pageref{p:IDAMonitorFn} \\
  \hline
  \multirow{10}{*}{\begin{sideways} Backward problems \end{sideways}}
  &  IDARhsFnB        &  residual function & \pageref{p:IDARhsFnB} \\
  &  IDAQuadRhsFnB    &  quadrature RHS function & \pageref{p:IDAQuadRhsFnB} \\
  &  IDADenseJacFnB   &  dense Jacobian function & \pageref{p:IDADenseJacFnB} \\
  &  IDABandJacFnB    &  banded Jacobian function & \pageref{p:IDABandJacFnB} \\
  &  IDAJacTimesVecFnB&  Jacobian times vector function & \pageref{p:IDAJacTimesVecFnB} \\
  &  IDAPrecSetupFnB  &  preconditioner setup function & \pageref{p:IDAPrecSetupFnB} \\
  &  IDAPrecSolveFnB  &  preconditioner solve function & \pageref{p:IDAPrecSolveFnB} \\
  &  IDAGlocalFnB     &  residual approximation function (BBDPre) & \pageref{p:IDAGlocalFnB} \\
  &  IDAGcommFnB      &  communication function (BBDPre) & \pageref{p:IDAGcommFnB} \\
  &  IDAMonitorFnB    &  monitoring function & \pageref{p:IDAMonitorFnB} \\
 \hline
\end{tabular}
\end{table}
